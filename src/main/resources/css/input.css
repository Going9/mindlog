@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --safe-area-inset-bottom: env(safe-area-inset-bottom);
    --bg-start: #f5f5f2;
    --bg-end: #ecece9;
    --surface: rgba(248, 248, 245, 0.8);
    --surface-strong: rgba(248, 248, 245, 0.92);
    --line: rgba(110, 114, 120, 0.17);
    --line-strong: rgba(110, 114, 120, 0.32);

    /* Emotion Palette (Insights) */
    --emotion-positive: #6d9f7f;
    --emotion-positive-strong: #3f6f52;
    --emotion-positive-soft: #b7d7bf;

    --emotion-negative: #bf7a88;
    --emotion-negative-strong: #8a4f5c;
    --emotion-negative-soft: #e2c0c7;

    --emotion-neutral: #8a817c;
    --emotion-neutral-strong: #57534e;
    --emotion-neutral-soft: #d6d3d1;
  }

  body {
    @apply text-stone-800 antialiased;
    background:
      radial-gradient(circle at 12% 8%, rgba(255, 255, 255, 0.55), rgba(255, 255, 255, 0) 36%),
      linear-gradient(160deg, #F7F7F4 0%, #F1F1EE 100%);
    /* [Safe Area] 하단 고정 요소가 있을 경우를 대비해 바디에 기본 여백 부여 */
    padding-bottom: var(--safe-area-inset-bottom);
    min-height: 100vh;
  }

  /* 앱 환경에서만 적용되는 글로벌 스타일 */
  .is-native {
    -webkit-tap-highlight-color: transparent;
    user-select: none;
  }
}

@layer components {

  .surface-panel {
    background: var(--surface);
    border: 1px solid var(--line);
    box-shadow: 0 18px 38px -28px rgba(24, 24, 27, 0.26), 0 4px 14px -10px rgba(24, 24, 27, 0.14);
    backdrop-filter: blur(12px);
    border-radius: 1rem;
  }

  .surface-panel-strong {
    background: var(--surface-strong);
    border: 1px solid var(--line);
    box-shadow: 0 20px 42px -30px rgba(24, 24, 27, 0.28), 0 4px 14px -10px rgba(24, 24, 27, 0.16);
    backdrop-filter: blur(12px);
    border-radius: 1rem;
  }

  .mindlog-card {
    @apply surface-panel p-5 transition-all duration-200;
  }

  .btn-primary {
    @apply inline-flex items-center justify-center gap-x-2 px-4 py-2.5 text-sm font-semibold rounded-xl text-white transition-all duration-200;
    background: linear-gradient(160deg, #3a3c40, #272a2e);
    box-shadow: 0 14px 24px -14px rgba(24, 24, 27, 0.58);
  }

  .btn-primary:hover {
    transform: translateY(-1px);
  }

  .btn-secondary {
    @apply inline-flex items-center justify-center gap-x-2 px-4 py-2.5 text-sm font-semibold rounded-xl text-stone-700 transition-all duration-200;
    background: rgba(248, 248, 245, 0.74);
    border: 1px solid var(--line);
    box-shadow: 0 10px 20px -18px rgba(24, 24, 27, 0.32);
  }

  .btn-secondary:hover {
    background: rgba(248, 248, 245, 0.92);
  }

  .glass-input {
    @apply block w-full rounded-xl text-sm px-4 py-3 text-stone-700 placeholder:text-stone-400 focus:outline-none focus:ring-2;
    background: rgba(248, 248, 245, 0.76);
    border: 1px solid var(--line);
    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.5);
    --tw-ring-color: rgba(99, 102, 110, 0.35);
  }

  .form-input {
    @apply glass-input disabled:opacity-50 disabled:pointer-events-none;
  }

  .form-label {
    @apply block text-sm font-medium mb-2 text-stone-600;
  }

  .page-shell {
    @apply max-w-4xl mx-auto px-4 py-8 sm:px-6 lg:px-8 space-y-6 pb-20;
  }

  .page-title {
    @apply text-3xl font-bold tracking-tight text-stone-800;
  }

  .page-subtitle {
    @apply text-sm text-stone-500;
  }

  .chip-soft {
    @apply inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-medium border;
    background: rgba(248, 248, 245, 0.86);
    border-color: var(--line-strong);
  }

  .tag-chip {
    @apply px-3 py-1.5 rounded-full text-sm font-medium border transition-all duration-200 select-none;
    background: rgba(248, 248, 245, 0.82);
    box-shadow: 0 8px 20px -16px rgba(24, 24, 27, 0.3);
  }

  .tag-delete-btn {
    @apply absolute -top-1 -right-1 inline-flex h-5 w-5 items-center justify-center rounded-full text-xs font-semibold transition-colors;
    background: rgba(41, 37, 36, 0.9);
    color: #fff;
    border: 1px solid rgba(255, 255, 255, 0.75);
  }

  .tag-delete-btn:hover {
    background: rgba(28, 25, 23, 1);
  }

  .mindlog-toast {
    position: fixed;
    left: 50%;
    bottom: calc(1.25rem + env(safe-area-inset-bottom));
    transform: translateX(-50%);
    z-index: 90;
    width: min(92vw, 26rem);
    pointer-events: none;
  }

  .mindlog-toast-content {
    border-radius: 0.9rem;
    border: 1px solid var(--line);
    background: rgba(248, 248, 245, 0.95);
    color: #44403c;
    box-shadow: 0 14px 26px -20px rgba(24, 24, 27, 0.42);
    backdrop-filter: blur(10px);
    padding: 0.75rem 0.9rem;
    font-size: 0.875rem;
    font-weight: 500;
  }

  .mindlog-toast-success .mindlog-toast-content {
    border-color: var(--emotion-positive-soft);
    color: var(--emotion-positive-strong);
    background: linear-gradient(180deg, rgba(248, 251, 248, 0.97) 0%, rgba(242, 248, 243, 0.97) 100%);
  }

  .mindlog-toast-error .mindlog-toast-content {
    border-color: var(--emotion-negative-soft);
    color: var(--emotion-negative-strong);
    background: linear-gradient(180deg, rgba(251, 247, 248, 0.97) 0%, rgba(249, 242, 244, 0.97) 100%);
  }

  .mindlog-toast-info .mindlog-toast-content {
    border-color: var(--emotion-neutral-soft);
    color: var(--emotion-neutral-strong);
  }
}

@layer utilities {

  /* 하단 고정 버튼 레이아웃용 */
  .pb-safe {
    padding-bottom: env(safe-area-inset-bottom);
  }

  /* 앱 환경에서 특정 요소를 강제로 숨기고 싶을 때 */
  .is-native .web-only {
    display: none !important;
  }
}

/* input.css 혹은 해당 레이아웃 컨테이너 */
.container {
  padding-left: env(safe-area-inset-left);
  padding-right: env(safe-area-inset-right);
}

/* ===== Turbo Loading Feedback Styles ===== */
/* @layer 밖에서 정의하여 항상 포함되도록 함 */

/* 로딩 중 상태 - 클릭 비활성화 및 시각적 피드백 */
[data-mindlog-busy="true"] {
  pointer-events: none;
  opacity: 0.7;
}

/* 버튼/링크 로딩 상태 */
.turbo-loading {
  pointer-events: none;
  opacity: 0.7;
  cursor: wait;
}

/* 로딩 스피너 - 기본 숨김 상태 */
.loading-spinner {
  display: none !important;
}

/* 로딩 중일 때 스피너 표시 및 회전 애니메이션 */
.turbo-loading .loading-spinner,
[data-mindlog-busy="true"] .loading-spinner {
  display: inline-block !important;
  animation: spin 1s linear infinite;
}

/* 로딩 중일 때 원래 텍스트/아이콘 숨김 */
.turbo-loading .loading-hide,
[data-mindlog-busy="true"] .loading-hide {
  display: none !important;
}

/* 로딩 중일 때만 표시되는 요소 */
.turbo-loading-show {
  display: none !important;
}

.turbo-loading .turbo-loading-show,
[data-mindlog-busy="true"] .turbo-loading-show {
  display: inline !important;
}
