<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout/base :: base(~{::title}, ~{::section}, ~{::#specific-scripts}, 'Mindlog - ë‹¹ì‹ ì˜ ê°ì •ì¼ê¸°')}">
<head>
    <title>Mindlog</title>
</head>
<body>
<section class="container mx-auto"> <div class="container mt-20">
    <div class="logo text-center mb-10">
        <h1 class="text-5xl font-bold text-gradient-mindlog mb-4">Mindlog</h1>
        <p class="text-mindlog-text-secondary text-lg">ë‹¹ì‹ ì˜ ê°ì •ì¼ê¸°</p>
    </div>

    <div id="logged-in" class="card hidden bg-white/5 backdrop-blur-lg border border-white/10 rounded-2xl p-8 text-center max-w-md mx-auto">
        <div class="success-badge text-green-400 mb-6">âœ“ ë¡œê·¸ì¸ ì„±ê³µ</div>
        <div class="user-info mb-8">
            <div class="avatar w-20 h-20 rounded-full mx-auto mb-4 bg-gradient-to-tr from-purple-500 to-blue-500 flex items-center justify-center text-3xl" id="user-avatar">ğŸ‘¤</div>
            <div class="name text-xl font-semibold text-white" id="user-name">ì‚¬ìš©ì</div>
            <div class="email text-mindlog-text-secondary" id="user-email">email@example.com</div>
        </div>
        <a href="/auth/logout" class="btn bg-white/10 text-white px-6 py-2 rounded-lg hover:bg-white/20 transition-all">ë¡œê·¸ì•„ì›ƒ</a>
    </div>

    <div id="logged-out" class="card hidden bg-white/5 backdrop-blur-lg border border-white/10 rounded-2xl p-8 text-center max-w-md mx-auto">
        <p class="guest-message text-mindlog-text-secondary mb-8">ì†Œì…œ ê³„ì •ìœ¼ë¡œ ê°„í¸í•˜ê²Œ ì‹œì‘í•˜ì„¸ìš”</p>
        <a href="/auth/login" class="btn bg-gradient-to-r from-purple-600 to-blue-600 text-white px-10 py-3 rounded-xl font-semibold hover:scale-105 transition-all inline-block">ë¡œê·¸ì¸</a>
    </div>
</div>
</section>

<div id="specific-scripts">
    <script th:inline="javascript">
        (function() {
            async function checkAuth() {
                // turbo-init.jsê°€ ë§Œë“  í´ë¼ì´ì–¸íŠ¸ë¥¼ ê¸°ë‹¤ë¦¼
                const client = window.supabaseClient;
                if (!client) { setTimeout(checkAuth, 50); return; }

                const { data: { session } } = await client.auth.getSession();
                const loggedInDiv = document.getElementById('logged-in');
                const loggedOutDiv = document.getElementById('logged-out');

                if (session && session.user) {
                    loggedInDiv.classList.remove('hidden');
                    const user = session.user;
                    const metadata = user.user_metadata || {};
                    document.getElementById('user-name').textContent = metadata.full_name || metadata.name || 'ì‚¬ìš©ì';
                    document.getElementById('user-email').textContent = user.email || '';
                    if (metadata.avatar_url) {
                        document.getElementById('user-avatar').innerHTML = `<img src="${metadata.avatar_url}" class="w-full h-full rounded-full object-cover">`;
                    }
                } else {
                    loggedOutDiv.classList.remove('hidden');
                }
            }
            checkAuth();
        })();
    </script>
</div>
</body>
</html>